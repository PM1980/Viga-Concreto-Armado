import streamlit as st
import sympy as sp

def calculate_moment_of_resistance(b, d, Aaço, Eaço, Econc, sigma_aço, sigma_conc):
    n = Eaço / Econc
    x = sp.symbols('x')
    eq_linha_neutra = b * x**2/2 - n * Aaço * (d-x)
    sol = sp.solve(eq_linha_neutra)
    x = max(sol)
    Ieq = (b*x**3/12) + (b*x)*(x/2)**2 + n * Aaço * (d-x)**2
    Mconc = sigma_conc * Ieq / x
    Maço = sigma_aço * Ieq / ((d-x) * n)
    return min(Mconc, Maço)

def main():
    st.title("Moment of Resistance Calculator")
    st.write("Enter the values to calculate the moment of resistance")

    b = st.text_input("Base of the section (m)")
    d = st.text_input("Effective height of the section (m)")
    Aaço = st.text_input("Total area of reinforcement (m2)")
    Eaço = st.text_input("Elastic modulus of steel (GPa)")
    Econc = st.text_input("Elastic modulus of concrete (GPa)")
    sigma_aço = st.text_input("Allowable stress for steel (Pa)")
    sigma_conc = st.text_input("Allowable stress for concrete (Pa)")

    if st.button("Calculate"):
        try:
            b = float(b)
            d = float(d)
            Aaço = float(Aaço)
            Eaço = float(Eaço)
            Econc = float(Econc)
            sigma_aço = float(sigma_aço)
            sigma_conc = float(sigma_conc)

            moment_of_resistance = calculate_moment_of_resistance(
                b, d, Aaço, Eaço, Econc, sigma_aço, sigma_conc
            )

            st.success(f"The moment of resistance is: {moment_of_resistance} N.m")
        except ValueError:
            st.error("Please enter valid numerical values")

if __name__ == "__main__":
    main()
